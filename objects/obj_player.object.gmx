<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_player</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>100</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Init EDE
//Stop collisions from spinning the ship
phy_fixed_rotation = true; 
phy_bullet = true;

image_blend = make_color_rgb(214,238,255);

// Create the wings
leftWingMotorSpeed = 20;
rightWingMotorSpeed = -leftWingMotorSpeed;

leftWingInstance = instance_create(x - 13, y + 14, obj_playerLeftWing);
leftWingJoint = physics_joint_revolute_create(id, leftWingInstance, x - 17, y + 12, -45, 0, true, 20, leftWingMotorSpeed, true,false);

rightWingInstance = instance_create(x + 13, y + 14, obj_playerRightWing);
rightWingJoint = physics_joint_revolute_create(id, rightWingInstance, x + 17, y + 12, 0, 45, true, 20, rightWingMotorSpeed, true,false);

// Create the boost effect
boost = instance_create(x, y - 30, obj_boost);
boost.target = id;
boost.offsetX = 0;
boost.offsetY = -25;

// Create the hud
instance_create(x, y, obj_gui);
instance_create(x, y, obj_health);
instance_create(x, y, obj_life);
instance_create(x, y, obj_energy);
instance_create(x, y, obj_score);

// Create the controls
instance_create(0, 0, obj_controls);

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Init particles

// Create a centered particle system (on EDE)
systemCentered = part_system_create();
part_system_depth(systemCentered,201);
// Create particle system
system = part_system_create();
part_system_depth(system,202);

// Smoke effect when EDE is damaged
emitterSmoke = part_emitter_create(system);
particleSmoke = part_type_create();
part_type_alpha3(particleSmoke,0.8,0.2,0);
part_type_speed(particleSmoke,-PHY_SPEED_Y,-PHY_SPEED_Y,0,true);
part_type_blend(particleSmoke,false);
part_type_direction(particleSmoke,80,100,0,false);
part_type_shape(particleSmoke,pt_shape_smoke);

// health bonus effect
emitterHealthBonus = part_emitter_create(systemCentered);
particleHealthBonus = part_type_create();
part_type_color1(particleHealthBonus,c_red);
part_type_size(particleHealthBonus,2,0,-0.05,false);
part_type_life(particleHealthBonus,room_speed,room_speed);
part_type_alpha2(particleHealthBonus,1,0);
part_type_sprite(particleHealthBonus,spr_bonusParticle,false,false,true);

// energy bonus effect
emitterEnergyBonus = part_emitter_create(systemCentered);
particleEnergyBonus = part_type_create();
part_type_color1(particleEnergyBonus,COLOR_ENERGY);
part_type_size(particleEnergyBonus,2,0,-0.05,false);
part_type_life(particleEnergyBonus,room_speed,room_speed);
part_type_alpha2(particleEnergyBonus,1,0);
//part_type_shape(particleEnergyBonus,pt_shape_circle);
part_type_sprite(particleEnergyBonus,spr_bonusSpiralParticle,false,false,false);
part_type_orientation(particleEnergyBonus,0,360,3,true,true);

// Autoheal effect 
particleAutoHeal = part_type_create();
part_type_color1(particleAutoHeal,c_red);
part_type_size(particleAutoHeal,2.5,0,-0.05,false);
part_type_life(particleAutoHeal,room_speed,room_speed);
part_type_alpha2(particleAutoHeal,1,0);
part_type_shape(particleAutoHeal,pt_shape_flare);
//part_type_sprite(particleAutoHeal,spr_bonusParticle,false,false,false);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy EDE and the HUD

// Destroy the wings
physics_joint_delete(leftWingJoint);
with (leftWingInstance){
    instance_destroy();
}

physics_joint_delete(rightWingJoint);
with (rightWingInstance){
    instance_destroy();
}

// Destroy the boost
with (boost){
    instance_destroy();
}

// Destroy the hud
with (obj_gui){
    instance_destroy();
}

with (obj_health){
    instance_destroy();
}

with (obj_life){
    instance_destroy();
}

with (obj_energy){
    instance_destroy();
}

with (obj_score){
    instance_destroy();
}

with (obj_obstacleIndicator){
    instance_destroy();
}

// Destroy the controls
with (obj_controls){
    instance_destroy();
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy particles
part_particles_clear(particleSmoke);
part_particles_clear(particleHealthBonus);
part_particles_clear(particleEnergyBonus);
part_particles_clear(particleAutoHeal);
part_emitter_clear(system,emitterSmoke);
part_emitter_clear(systemCentered,emitterHealthBonus);
part_emitter_clear(systemCentered,emitterEnergyBonus);
part_system_destroy(systemCentered);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update particles

// Update particle emitter position
part_emitter_region(system,emitterSmoke,x - 10,x + 10, y - 40,y-20,ps_shape_ellipse,ps_distr_gaussian);

// Update centered particle system position to stay on EDE
part_system_position(systemCentered,x,y);
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update boost
var scale;
scale = phy_linear_velocity_y / 200;
scale = max(-0.5,scale);
scale = min(0.5,scale);
scale = scale + 0.5;
boost.image_xscale = scale;
boost.image_yscale = scale;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="11">
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_updateAutoHealing</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>false</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="7">
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_updateAutoHealing</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>false</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="4">
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_updateAutoHealing</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>true</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="25">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Move</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Move the player
show_debug_message("move");

var _energy;
with(obj_energy){
    _energy = energy;
}
if _energy &gt; 0 {

    // Do nothing when the player clicks on EDE, it is used to activate autoHealing
    if distance_to_point(mouse_x,mouse_y) &lt;= sprite_width / 2 {
        exit;
    }

    scr_applyForce(5,15);
    var xDelta;
    xDelta = mouse_x - x;
    /*
    var yDelta;
    yDelta = mouse_y - y;

    // Move EDE        
    physics_apply_local_force(0, 0, 1 * xDelta, 1 * yDelta);
    
    var angleDegrees;
    angleDegrees = point_direction(x, y, mouse_x, mouse_y);
    var angleRad;
    angleRad = degtorad(angleDegrees); 
    physics_apply_local_impulse(0, 0, 20 * cos(angleRad), - 20 * sin(angleRad));*/
    
    // Use some energy
    with(obj_energy){
        energy -= 1;
        event_user(1);
    }
    
    // Move the wings
    if (xDelta &gt; 0){
        physics_joint_set_value(leftWingJoint, phy_joint_motor_speed, -leftWingMotorSpeed);
        leftWingInstance.boost.visible = true;
        physics_joint_set_value(rightWingJoint, phy_joint_motor_speed, rightWingMotorSpeed);
    } else {
        physics_joint_set_value(leftWingJoint, phy_joint_motor_speed, leftWingMotorSpeed);
        physics_joint_set_value(rightWingJoint, phy_joint_motor_speed, -rightWingMotorSpeed);
        rightWingInstance.boost.visible = true;
    }    
}else{
    scr_reinitPlayer();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="24">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Move End</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>601</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_execute_script</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>9</kind>
            <script>scr_reinitPlayer</script>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
          <argument>
            <kind>0</kind>
            <string>0</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="13">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Repulse bullet</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Repulse bullet
show_debug_message("Test : Down direction" + " x:" + string(eventX) + " y:"+ string(eventY) + " w:" + string(eventWidth) + " h:" + string(eventHeight));

if (!instance_exists(obj_repulseBullet)){
    var angle;
    angle = point_direction(x,y, eventX,eventY);
    if (angle &gt; 210 &amp;&amp; angle &lt; 330){
        var bullet; 
        bullet = instance_create(x, y + 30, obj_repulseBullet);
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="12">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Tractor beam</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// create a tractor
show_debug_message("Test : Up direction" + " x:" + string(eventX) + " y:"+ string(eventY) + " w:" + string(eventWidth) + " h:" + string(eventHeight));
if (!instance_exists(obj_tractorBeam)){
    instance_create(eventX,eventY,obj_tractorBeam);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Test</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Left direction 
show_debug_message("Test : left direction" + " x:" + string(eventX) + " y:"+ string(eventY) + " w:" + string(eventWidth) + " h:" + string(eventHeight));
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Fire</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Fire
show_debug_message("fire" + " x:" + string(eventX) + " y:"+ string(eventY) + " w:" + string(eventWidth) + " h:" + string(eventHeight));

var angle;
angle = point_direction(x,y, eventX,eventY);
if (angle &gt; 210 &amp;&amp; angle &lt; 330){
    var bullet; 
    bullet = instance_create(x, y + 30, obj_bullet);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>-1</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>1</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.200000002980232</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>50,50</point>
    <point>25,0</point>
  </PhysicsShapePoints>
</object>
